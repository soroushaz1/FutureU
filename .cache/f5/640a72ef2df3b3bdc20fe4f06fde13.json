{"id":"node_modules/@babylonjs/core/Shaders/ShadersInclude/reflectionFunction.js","dependencies":[{"name":"F:\\FutureU\\babylonjs\\node_modules\\@babylonjs\\core\\Shaders\\ShadersInclude\\reflectionFunction.js.map","includedInParent":true,"mtime":1704105649855},{"name":"F:\\FutureU\\babylonjs\\package.json","includedInParent":true,"mtime":1704105536080},{"name":"F:\\FutureU\\babylonjs\\node_modules\\@babylonjs\\core\\package.json","includedInParent":true,"mtime":1704105648327},{"name":"../../Engines/shaderStore.js","loc":{"line":2,"column":28,"index":44},"parent":"F:\\FutureU\\babylonjs\\node_modules\\@babylonjs\\core\\Shaders\\ShadersInclude\\reflectionFunction.js","resolved":"F:\\FutureU\\babylonjs\\node_modules\\@babylonjs\\core\\Engines\\shaderStore.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.reflectionFunction = void 0;\nvar _shaderStore = require(\"../../Engines/shaderStore.js\");\n// Do not edit.\n\nconst name = \"reflectionFunction\";\nconst shader = `vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0); \n}\nvec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(1.0-s,t,0); \n}\nvec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);\nvec3 r=normalize(reflect(cameraToVertex,worldNormal));\nr=vec3(reflectionMatrix*vec4(r,0));\nfloat lon=atan(r.z,r.x);\nfloat lat=acos(r.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0);\n}\nvec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(vec3(view*worldPos));\nvec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));\nvec3 r=reflect(viewDir,viewNormal);\nr=vec3(reflectionMatrix*vec4(r,0));\nr.z=r.z-1.0;\nfloat m=2.0*length(r);\nreturn vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);\n}\nvec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=worldPos.xyz-eyePosition;\nvec3 coords=normalize(reflect(viewDir,worldNormal));\nreturn vec3(reflectionMatrix*vec4(coords,1));\n}\nvec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*(view*worldPos));\n}\nvec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*vec4(positionW,1.));\n}\n#ifdef REFLECTION\nvec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\n{\n#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR\nreturn computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SPHERICAL\nreturn computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_PLANAR\nreturn computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_CUBIC\n#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC\nreturn computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);\n#else\nreturn computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#endif\n#ifdef REFLECTIONMAP_PROJECTION\nreturn computeProjectionCoords(worldPos,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nreturn computeSkyBoxCoords(vPositionUVW,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_EXPLICIT\nreturn vec3(0,0,0);\n#endif\n}\n#endif\n`;\n// Sideeffect\n_shaderStore.ShaderStore.IncludesShadersStore[name] = shader;\n/** @internal */\nconst reflectionFunction = exports.reflectionFunction = {\n  name,\n  shader\n};"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":7,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":7,"column":4}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":7,"column":16}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":7,"column":19}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":7,"column":26}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":8,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":10,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":4,"column":6},"generated":{"line":10,"column":6}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":4,"column":10},"generated":{"line":10,"column":10}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":4,"column":13},"generated":{"line":10,"column":13}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":4,"column":33},"generated":{"line":10,"column":33}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":11,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":5,"column":6},"generated":{"line":11,"column":6}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":5,"column":12},"generated":{"line":11,"column":12}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":5,"column":15},"generated":{"line":11,"column":15}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":118,"column":1},"generated":{"line":124,"column":1}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":119,"column":0},"generated":{"line":125,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":0},"generated":{"line":126,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":11},"generated":{"line":126,"column":24}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":12},"generated":{"line":126,"column":25}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":32},"generated":{"line":126,"column":45}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":33},"generated":{"line":126,"column":46}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":37},"generated":{"line":126,"column":50}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":38},"generated":{"line":126,"column":51}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":41},"generated":{"line":126,"column":54}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":120,"column":47},"generated":{"line":126,"column":60}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":121,"column":0},"generated":{"line":127,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":7},"generated":{"line":128,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":13},"generated":{"line":128,"column":6}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":31},"generated":{"line":128,"column":24}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":31},"generated":{"line":128,"column":27}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":31},"generated":{"line":128,"column":34}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":31},"generated":{"line":128,"column":35}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":31},"generated":{"line":128,"column":53}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":34},"generated":{"line":128,"column":56}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":36},"generated":{"line":129,"column":2}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":40},"generated":{"line":129,"column":6}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":42},"generated":{"line":130,"column":2}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":48},"generated":{"line":131,"column":0}},{"source":"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts","name":null,"original":{"line":122,"column":50},"generated":{"line":131,"column":1}}],"sources":{"../../../../../lts/core/generated/Shaders/ShadersInclude/reflectionFunction.ts":"// Do not edit.\nimport { ShaderStore } from \"../../Engines/shaderStore\";\n\nconst name = \"reflectionFunction\";\nconst shader = `vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\r{\rfloat lon=atan(direction.z,direction.x);\rfloat lat=acos(direction.y);\rvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\rfloat s=sphereCoords.x*0.5+0.5;\rfloat t=sphereCoords.y;\rreturn vec3(s,t,0); \r}\rvec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\r{\rfloat lon=atan(direction.z,direction.x);\rfloat lat=acos(direction.y);\rvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\rfloat s=sphereCoords.x*0.5+0.5;\rfloat t=sphereCoords.y;\rreturn vec3(1.0-s,t,0); \r}\rvec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\r{\rvec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);\rvec3 r=normalize(reflect(cameraToVertex,worldNormal));\rr=vec3(reflectionMatrix*vec4(r,0));\rfloat lon=atan(r.z,r.x);\rfloat lat=acos(r.y);\rvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\rfloat s=sphereCoords.x*0.5+0.5;\rfloat t=sphereCoords.y;\rreturn vec3(s,t,0);\r}\rvec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)\r{\rvec3 viewDir=normalize(vec3(view*worldPos));\rvec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));\rvec3 r=reflect(viewDir,viewNormal);\rr=vec3(reflectionMatrix*vec4(r,0));\rr.z=r.z-1.0;\rfloat m=2.0*length(r);\rreturn vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);\r}\rvec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\r{\rvec3 viewDir=worldPos.xyz-eyePosition;\rvec3 coords=normalize(reflect(viewDir,worldNormal));\rreturn vec3(reflectionMatrix*vec4(coords,1));\r}\rvec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\r{\rvec3 viewDir=normalize(worldPos.xyz-eyePosition);\rvec3 coords=reflect(viewDir,worldNormal);\rcoords=vec3(reflectionMatrix*vec4(coords,0));\r#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\r#endif\nreturn coords;\r}\rvec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)\r{\rvec3 viewDir=normalize(worldPos.xyz-eyePosition);\rvec3 coords=reflect(viewDir,worldNormal);\rcoords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);\rcoords=vec3(reflectionMatrix*vec4(coords,0));\r#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\r#endif\nreturn coords;\r}\rvec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)\r{\rreturn vec3(reflectionMatrix*(view*worldPos));\r}\rvec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)\r{\rreturn vec3(reflectionMatrix*vec4(positionW,1.));\r}\r#ifdef REFLECTION\nvec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\r{\r#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\rreturn computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);\r#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\rreturn computeFixedEquirectangularCoords(worldPos,worldNormal,direction);\r#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR\nreturn computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\r#endif\n#ifdef REFLECTIONMAP_SPHERICAL\nreturn computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);\r#endif\n#ifdef REFLECTIONMAP_PLANAR\nreturn computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\r#endif\n#ifdef REFLECTIONMAP_CUBIC\n#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC\nreturn computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);\r#else\nreturn computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\r#endif\n#endif\n#ifdef REFLECTIONMAP_PROJECTION\nreturn computeProjectionCoords(worldPos,view,reflectionMatrix);\r#endif\n#ifdef REFLECTIONMAP_SKYBOX\nreturn computeSkyBoxCoords(vPositionUVW,reflectionMatrix);\r#endif\n#ifdef REFLECTIONMAP_EXPLICIT\nreturn vec3(0,0,0);\r#endif\n}\r#endif\n`;\n// Sideeffect\nShaderStore.IncludesShadersStore[name] = shader;\n/** @internal */\nexport const reflectionFunction = { name, shader };\n"},"lineCount":null}},"error":null,"hash":"5240757c1a399a6a86d7109f902fa8e6","cacheData":{"env":{}}}